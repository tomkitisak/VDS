@using Microsoft.AspNetCore.Identity
@inject UserManager<ApplicationUser> _userManager
@inject vds.Data.ApplicationDbContext _context;
@{
    var email = "";
    var usertype = "";
    var username = "";
    var hospitalId = "";
    var hospitalName = "";
    var coordinatorId = "";
    var userid = "";
    var user1 = await _userManager.GetUserAsync(User);

    if (user1 != null)
    {
        email = user1.Email;
        username = user1.UserName;
        usertype = user1.UserTypeId;
        if (usertype == "1")
        {
            userid = _userManager.GetUserId(User);
            hospitalId = _context.Hospital.Where(x => x.CreatedById.Equals(userid)).Select(x => x.HospitalId).FirstOrDefault();
            hospitalName = _context.Hospital.Where(x => x.HospitalId.Equals(hospitalId)).Select(x => x.HospitalName).FirstOrDefault();
            coordinatorId = _context.Coordinator.Where(x => x.CreatedById.Equals(userid)).Select(x => x.CoordinatorId).FirstOrDefault();
        }

        TempData["userTypeId"] = usertype;
        TempData["hospitalId"] = hospitalId;
        TempData["hospitalName"] = hospitalName; 

    }


}

<!-- Left Navigation Start -->
<aside class="main-header">
    <nav class="navbar">
        <ul class="navbar-nav">
            <li class="nav-heading">
                สวัสดี @email
            </li>


            <!--Todo-->
            @if (User.IsInRole(Pages.Todo.RoleName))
            {
                <li class="nav-item @Html.IsSelected(controller: Pages.Todo.ControllerName)Route">
                    <a class="nav-link waves-effect" title="@Pages.Todo.NavigationName" href="@Pages.Todo.UrlDefault?period=@(DateTime.Now.ToString("MM-yyyy", new System.Globalization.CultureInfo("en-US")))">
                        <i class="mdi mdi-calendar-multiple-check md-24 mr-2"></i>
                        <span class="menu-title">@Pages.Todo.NavigationName</span>
                    </a>
                </li>

            }

            <!-- Job  -->
            @if (User.IsInRole(Pages.Job.RoleName))
            {


                <li class="nav-item @Html.IsSelected(controller: Pages.Job.ControllerName)Route">
                    <a class="nav-link waves-effect" title="@Pages.Job.NavigationName" href="@Pages.Job.UrlDefault">
                        <i class="mdi mdi-laptop-mac md-24 mr-2"></i>
                        <span class="menu-title">@Pages.Job.NavigationName</span>
                    </a>
                </li>

            }




            <!--Doctor-->

            @if (User.IsInRole(Pages.Doctor.RoleName))
            {

                <li class="nav-item @Html.IsSelected(controller: Pages.Doctor.ControllerName)Route">
                    <a class="nav-link waves-effect" title="@Pages.Doctor.NavigationName" href="@Pages.Doctor.UrlDefault">
                        <i class="mdi mdi-human md-24 mr-2"></i>
                        <span class="menu-title">@Pages.Doctor.NavigationName</span>
                    </a>
                </li>
            }


            <!--DoctorGroup-->

            @if (User.IsInRole(Pages.DoctorGroup.RoleName))
            {
                <li class="nav-item @Html.IsSelected(controller: Pages.DoctorGroup.ControllerName)Route">
                    <a class="nav-link waves-effect" title="@Pages.DoctorGroup.NavigationName" href="@Pages.DoctorGroup.UrlDefault">
                        <i class="mdi mdi-human-greeting md-24 mr-2"></i>
                        <span class="menu-title">@Pages.DoctorGroup.NavigationName</span>
                    </a>
                </li>
            }




            <!-- Patient -->
            @if (User.IsInRole(Pages.Patient.RoleName))
            {


                if (usertype == "1")
                {

                    <li class="nav-item @Html.IsSelected(controller: Pages.Patient.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Patient.NavigationName" href="@Pages.Patient.UrlDefault?id=@hospitalId&userTypeId=@usertype">
                            <i class="mdi mdi-human-male-female md-24 mr-2"></i>
                            <span class="menu-title">@Pages.Patient.NavigationName</span>
                        </a>
                    </li>
                }
                else
                {
                    <li class="nav-item @Html.IsSelected(controller: Pages.Patient.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Patient.NavigationName" href="@Pages.Patient.UrlDefault?period=@(DateTime.Now.ToString("MM-yyyy"))">
                            <i class="mdi mdi-human-male-female md-24 mr-2"></i>
                            <span class="menu-title">@Pages.Patient.NavigationName</span>
                        </a>
                    </li>
                }

            }


            <!-- Hospital -->
            @if (User.IsInRole(Pages.Hospital.RoleName))
            {
                if (usertype == "1")
                {

                    <li class="nav-item @Html.IsSelected(controller: Pages.Hospital.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Hospital.NavigationName" href="@Pages.Hospital.UrlDefaultType1?id=@hospitalId">
                            <i class="mdi mdi-home md-24 mr-2"></i>
                            <span class="menu-title">@Pages.Hospital.NavigationName</span>
                        </a>
                    </li>

                }
                else
                {


                    <li class="nav-item @Html.IsSelected(controller: Pages.Hospital.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Hospital.NavigationName" href="@Pages.Hospital.UrlDefault?period=@(DateTime.Now.ToString("MM-yyyy"))">
                            <i class="mdi mdi-home md-24 mr-2"></i>
                            <span class="menu-title">@Pages.Hospital.NavigationName</span>
                        </a>
                    </li>


                }


            }


            <!--Employee-->
            @if (User.IsInRole(Pages.Employee.RoleName))
            {
                if (usertype == "1")
                {
                    <li class="nav-item @Html.IsSelected(controller: Pages.Employee.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Employee.NavigationName" href="@Pages.Employee.UrlDefaultType1?id=@coordinatorId">
                            <i class="mdi mdi-human-female md-24 mr-2"></i>
                            <span class="menu-title">@Pages.Employee.NavigationName</span>
                        </a>
                    </li>
                }
                else
                {

                    <li class="nav-item @Html.IsSelected(controller: Pages.Employee.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Employee.NavigationName" href="@Pages.Employee.UrlDefault">
                            <i class="mdi mdi-human-female md-24 mr-2"></i>
                            <span class="menu-title">@Pages.Employee.NavigationName</span>
                        </a>
                    </li>


                }
            }



            <!--Membership-->
            @if (User.IsInRole(Pages.Membership.RoleName))
            {
                <li class="nav-item @Html.IsSelected(controller: Pages.Membership.ControllerName)Route">
                    <a class="nav-link waves-effect" title="@Pages.Membership.NavigationName" href="@Pages.Membership.UrlDefault">
                        <i class="mdi mdi-account-settings-variant md-24 mr-2"></i>
                        <span class="menu-title">@Pages.Membership.NavigationName</span>
                    </a>
                </li>
            }



            <!--Role-->
            @if (User.IsInRole(Pages.Role.RoleName))
            {
                <li class="nav-item @Html.IsSelected(controller: Pages.Role.ControllerName)Route" hidden>
                    <a class="nav-link waves-effect" title="@Pages.Role.NavigationName" href="@Pages.Role.UrlDefault">
                        <i class="mdi mdi-door-open md-24 mr-2"></i>
                        <span class="menu-title">@Pages.Role.NavigationName</span>
                    </a>
                </li>
            }



            <li class="nav-item">
                <a class="nav-link waves-effect" title="@Pages.Patient.NavigationName" href="#" ))">
                    <i class="mdi mdi-apps md-24 mr-2"></i>
                    <span class="menu-title">Setting</span>
                </a>

                @*<div class="dropdown d-inline">
                        <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuOutlineButton1"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            ข้อมูลระบบ
                        </button>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuOutlineButton1" x-placement="top-start"
                             style="position: absolute; transform: translate3d(0px, -185px, 0px); top: 0px; left: 0px; will-change: transform;">
                            <h6 class="dropdown-header"><b>เพิ่มข้อมูลใหม่</b></h6>
                            <a class="dropdown-item" href="~/settings/AddPrefixType">ข้อมูลคำนำหน้าชื่อ</a>
                            <a class="dropdown-item" href="~/settings/AddDoctorType">สาขาความเชี่ยวชาญ</a>


                        </div>
                    </div>*@

            </li>



            @*ffff

                <!--Todo: Recruitment for another version-->
                @if (User.IsInRole(Pages.Recruitment.RoleName))
                {
                    <li hidden class="nav-item @Html.IsSelected(controller: Pages.Recruitment.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Recruitment.NavigationName" href="@Pages.Recruitment.UrlDefault">
                            <i class="mdi mdi-account-multiple-plus md-18 mr-2"></i>
                            <span class="menu-title">@Pages.Recruitment.NavigationName</span>
                        </a>
                    </li>
                }

                <!--Todo: Settings for another version-->
                @if (User.IsInRole(Pages.Settings.RoleName))
                {
                    <li hidden class="nav-item @Html.IsSelected(controller: Pages.Settings.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Settings.NavigationName" href="@Pages.Settings.UrlDefault">
                            <i class="mdi mdi-brightness-7 md-18 mr-2"></i>
                            <span class="menu-title">@Pages.Settings.NavigationName</span>
                        </a>
                    </li>
                }


                <!--Attendance-->
                @if (User.IsInRole(Pages.Attendance.RoleName))
                {
                    <li class="nav-item @Html.IsSelected(controller: Pages.Attendance.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Attendance.NavigationName" href="@Pages.Attendance.UrlDefault?period=@(DateTime.Now.ToString("yyyy-MM"))">
                            <i class="mdi mdi-calendar-clock md-18 mr-2"></i>
                            <span class="menu-title">@Pages.Attendance.NavigationName</span>
                        </a>
                    </li>
                }

                <!--Leave-->
                @if (User.IsInRole(Pages.Leave.RoleName))
                {
                    <li class="nav-item @Html.IsSelected(controller: Pages.Leave.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Leave.NavigationName" href="@Pages.Leave.UrlDefault?period=@(DateTime.Now.ToString("yyyy-MM"))">
                            <i class="mdi mdi-beach md-18 mr-2"></i>
                            <span class="menu-title">@Pages.Leave.NavigationName</span>
                        </a>
                    </li>
                }

                <!--Award-->
                @if (User.IsInRole(Pages.Award.RoleName))
                {
                    <li class="nav-item @Html.IsSelected(controller: Pages.Award.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Award.NavigationName" href="@Pages.Award.UrlDefault?period=@(DateTime.Now.ToString("yyyy-MM"))">
                            <i class="mdi mdi-certificate md-18 mr-2"></i>
                            <span class="menu-title">@Pages.Award.NavigationName</span>
                        </a>
                    </li>
                }

                <!--Information-->
                @if (User.IsInRole(Pages.Information.RoleName))
                {
                    <li class="nav-item @Html.IsSelected(controller: Pages.Information.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Information.NavigationName" href="@Pages.Information.UrlDefault?period=@(DateTime.Now.ToString("yyyy-MM"))">
                            <i class="mdi mdi-newspaper md-18 mr-2"></i>
                            <span class="menu-title">@Pages.Information.NavigationName</span>
                        </a>
                    </li>
                }

                <!--Asset-->
                @if (User.IsInRole(Pages.Asset.RoleName))
                {
                    <li class="nav-item @Html.IsSelected(controller: Pages.Asset.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Asset.NavigationName" href="@Pages.Asset.UrlDefault?period=@(DateTime.Now.ToString("yyyy-MM"))">
                            <i class="mdi mdi-car md-18 mr-2"></i>
                            <span class="menu-title">@Pages.Asset.NavigationName</span>
                        </a>
                    </li>
                }

                <!--Expense-->
                @if (User.IsInRole(Pages.Expense.RoleName))
                {
                    <li class="nav-item @Html.IsSelected(controller: Pages.Expense.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Expense.NavigationName" href="@Pages.Expense.UrlDefault?period=@(DateTime.Now.ToString("yyyy-MM"))">
                            <i class="mdi mdi-cash-multiple md-18 mr-2"></i>
                            <span class="menu-title">@Pages.Expense.NavigationName</span>
                        </a>
                    </li>
                }

                <!--Payroll-->
                @if (User.IsInRole(Pages.Payroll.RoleName))
                {
                    <li class="nav-item @Html.IsSelected(controller: Pages.Payroll.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Payroll.NavigationName" href="@Pages.Payroll.UrlDefault?period=@(DateTime.Now.ToString("yyyy-MM"))">
                            <i class="mdi mdi-cash-usd md-18 mr-2"></i>
                            <span class="menu-title">@Pages.Payroll.NavigationName</span>
                        </a>
                    </li>
                }

                <!--Appraisal-->
                @if (User.IsInRole(Pages.Appraisal.RoleName))
                {
                    <li class="nav-item @Html.IsSelected(controller: Pages.Appraisal.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Appraisal.NavigationName" href="@Pages.Appraisal.UrlDefault?period=@(DateTime.Now.ToString("yyyy-MM"))">
                            <i class="mdi mdi-counter md-18 mr-2"></i>
                            <span class="menu-title">@Pages.Appraisal.NavigationName</span>
                        </a>
                    </li>
                }

                <!--Ticket-->
                @if (User.IsInRole(Pages.Ticket.RoleName))
                {
                    <li class="nav-item @Html.IsSelected(controller: Pages.Ticket.ControllerName)Route">
                        <a class="nav-link waves-effect" title="@Pages.Ticket.NavigationName" href="@Pages.Ticket.UrlDefault?period=@(DateTime.Now.ToString("yyyy-MM"))">
                            <i class="mdi mdi-comment-multiple-outline md-18 mr-2"></i>
                            <span class="menu-title">@Pages.Ticket.NavigationName</span>
                        </a>
                    </li>
                }


            *@


        </ul>
    </nav>
</aside>
<!-- Left Navigation End -->